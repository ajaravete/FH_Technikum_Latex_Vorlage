\documentclass[12pt,
	twoside=false,
	listof=totoc,
	bibliography=totoc,
	index=totoc]{scrartcl}

\input{special/preamble.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% DEFINITIONS
% Change those informations
\gdef\mytitle{Laborprotokoll}
\gdef\mythema{Ãœbung XY}

\gdef\mycourse{BIFx}
\gdef\mysubject{Fach}
\gdef\myauthor{Name}

\gdef\mykennzeichen{1234567890}
\gdef\mydatum{23.09.2017}
\gdef\myort{Wien}
\gdef\myteacher{Professor}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\renewcommand{\headrulewidth}{0.4pt}
%\renewcommand{\footrulewidth}{0.4pt}

% Header and Footer
\clearpairofpagestyles

\KOMAoptions{
	headsepline = true,
	footsepline = true
}

% Spacing between footer and footer line
\ModifyLayer[addvoffset=-.5ex]{scrheadings.foot.above.line}
\ModifyLayer[addvoffset=-.5ex]{plain.scrheadings.foot.above.line}

\setkomafont{pageheadfoot}{}
\setkomafont{pagehead}{}
\setkomafont{pagination}{}

\automark[section]{section}
\lohead*{\headmark}
\rofoot*{Seite \pagemark{} von \pageref*{LastPage}}
\lofoot*{\myauthor}

\renewcommand{\sectionmark}[1]{\markright{\thesection.\ \ \MakeUppercase{#1}}}
%\renewcommand{\subsectionmark}[1]{\markright{\thesubsection\ \ #1}}

\begin{document}
	
	% Title
	\pagestyle{empty}
	\pagenumbering{Roman}
	\input{special/title}
	\clearpage
	
	% Table of content
	\microtypesetup{protrusion=false}
	{
		% Footer for toc
		\clearpairofpagestyles
		\KOMAoptions{
			headsepline = false,
			footsepline = false
		}
		\cofoot{\pagemark}
		\pagestyle{scrheadings}
		
		\onehalfspacing
		\hypersetup{linkcolor=black}
		\tableofcontents
		\clearpage
	}

	% Main content
	\microtypesetup{protrusion=true}
	\pagenumbering{arabic}
	\pagestyle{scrheadings}
	\parindent 0pt
	\parskip 12pt
	
	\input{sections/task.tex}
	\input{sections/solution.tex}
	\clearpage
	
	% Bibliography, List of Tables, Figures, Listings
	\microtypesetup{protrusion=false}
	{
		\hypersetup{linkcolor=black}
		\parskip 0pt
		\onehalfspacing
		
		\listoffigures
		\listoftables
		
		% important because listoflistings has only single spacing
		\onehalfspacing
		\lstlistoflistings
		
		\singlespacing
		\printbibliography
	}
\end{document}
